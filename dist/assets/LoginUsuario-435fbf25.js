import{u as j,l as v,r as s,j as e}from"./index-1606e3a6.js";import{B as y}from"./BackLink-10c487b2.js";function k(){const{t:u}=j(),x=v(),[o,g]=s.useState(""),[i,w]=s.useState(""),[n,b]=s.useState(!1),[h,d]=s.useState(""),[c,m]=s.useState(!1),f=async a=>{if(a.preventDefault(),!(!o||!i||c)){d(""),m(!0);try{const r=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:o.trim(),password:i})}),l=await r.json();if(!r.ok){d((l==null?void 0:l.error)||"Error al iniciar sesión"),m(!1);return}const{token:p,user:t}=l;console.debug("[AUTH] login result",{status:r.status,hasToken:!!p,userId:t==null?void 0:t._id,role:t==null?void 0:t.role}),localStorage.setItem("token",p),localStorage.setItem("role",t.role),localStorage.setItem("user",JSON.stringify(t)),window.dispatchEvent(new Event("auth:changed")),t.role==="admin"||t.role==="editor"?x("/admin",{replace:!0}):x("/",{replace:!0})}catch(r){console.error(r),d("Error en el servidor. Intenta nuevamente.")}finally{m(!1)}}};return e.jsx("main",{className:"min-h-screen bg-transparent px-4 py-10 md:px-8",children:e.jsxs("div",{className:"mx-auto max-w-3xl",children:[e.jsx(y,{to:"/",label:"Volver al inicio"}),e.jsxs("header",{className:"mb-8 text-center",children:[e.jsx("h1",{className:"mt-3 bg-gradient-to-r from-red-500 via-red-400 to-rose-400 bg-clip-text text-3xl font-extrabold text-transparent md:text-4xl",children:"Inicia sesión"}),e.jsx("p",{className:"mx-auto mt-2 max-w-2xl text-sm text-white/70",children:"Accede con tu correo y contraseña."})]}),e.jsxs("section",{className:"rounded-2xl border border-white/10 bg-white/5 p-5 shadow-lg md:bg-white/10 md:backdrop-blur-md md:p-8",children:[h&&e.jsx("div",{className:"mb-4 rounded-lg border border-red-900/40 bg-red-900/20 px-3 py-2 text-sm text-red-200",children:h}),e.jsxs("form",{onSubmit:f,className:"space-y-6",noValidate:!0,children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{htmlFor:"email",className:"text-sm font-medium text-white",children:u("email")||"Correo"}),e.jsx("input",{id:"email",type:"email",inputMode:"email",autoComplete:"email",placeholder:"tu@empresa.com",value:o,onChange:a=>g(a.target.value),className:"w-full rounded-lg border border-white/10 bg-white/5 px-3 py-2.5 text-white placeholder-white/40 outline-none transition focus:ring-2 focus:ring-red-500/60",required:!0})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{htmlFor:"password",className:"text-sm font-medium text-white",children:u("password")||"Contraseña"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{id:"password",type:n?"text":"password",autoComplete:"current-password",value:i,onChange:a=>w(a.target.value),className:"w-full rounded-lg border border-white/10 bg-white/5 px-3 py-2.5 pr-20 text-white placeholder-white/40 outline-none transition focus:ring-2 focus:ring-red-500/60",required:!0}),e.jsx("button",{type:"button",onClick:()=>b(a=>!a),className:"absolute right-2 top-1/2 -translate-y-1/2 rounded-md px-2 py-1 text-xs text-white/70 hover:text-white","aria-label":n?"Ocultar contraseña":"Mostrar contraseña",children:n?"Ocultar":"Mostrar"})]})]}),e.jsxs("div",{className:"pt-2 flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[e.jsx("button",{type:"submit",disabled:c||!o||!i,className:"flex w-full items-center justify-center gap-2 rounded-lg px-4 py-2 text-sm font-semibold text-white transition-all duration-200 hover:opacity-95 disabled:cursor-not-allowed disabled:opacity-60 sm:w-auto",style:{WebkitAppearance:"none",backgroundColor:"#dc2626"},children:c?"Ingresando…":"Iniciar sesión"}),e.jsxs("div",{className:"text-center text-sm text-white/70 sm:text-right",children:["¿No tienes cuenta?"," ",e.jsx("a",{href:"/registro",className:"text-white hover:underline",children:"Crear cuenta"}),"  •  ",e.jsx("a",{href:"/forgot-password",className:"text-white hover:underline",children:"¿Olvidaste tu contraseña?"})]})]}),e.jsx("p",{className:"pt-4 text-center text-xs text-white/50",children:"Obligados al exilio… no hay abrazo que cierre lo que la dictadura parte."})]})]})]})})}export{k as default};
