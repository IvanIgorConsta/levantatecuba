import{l as C,r as a,j as e,L as w}from"./index-1606e3a6.js";const S={}.VITE_API_BASE_URL||"/api";function P(){const b=C(),[m,f]=a.useState(""),[r,g]=a.useState(""),[o,v]=a.useState(""),[i,j]=a.useState(!1),[l,N]=a.useState(!1),[u,x]=a.useState(""),[h,s]=a.useState(""),[p,c]=a.useState(!1);a.useEffect(()=>{const n=new URL(window.location.href).searchParams.get("token")||"";f(n)},[]);const y=async t=>{if(t.preventDefault(),x(""),s(""),!m){s("Token inválido o ausente. Vuelve a solicitar el enlace.");return}if(!r||!o){s("Completa ambos campos de contraseña.");return}if(r.length<6){s("La contraseña debe tener al menos 6 caracteres.");return}if(r!==o){s("Las contraseñas no coinciden.");return}try{c(!0);const n=await fetch(`${S}/password/reset`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:m,password:r})}),d=await n.json();if(!n.ok){s((d==null?void 0:d.error)||"No se pudo cambiar la contraseña."),c(!1);return}x("Contraseña actualizada. Ya puedes iniciar sesión."),setTimeout(()=>b("/login",{replace:!0}),1800)}catch{s("No se pudo conectar con el servidor.")}finally{c(!1)}};return e.jsx("main",{className:"min-h-screen bg-transparent px-4 py-10 md:px-8",children:e.jsxs("div",{className:"mx-auto max-w-3xl",children:[e.jsx("div",{className:"mb-8",children:e.jsxs(w,{to:"/",className:"inline-flex items-center text-sm text-white/70 hover:text-white",children:[e.jsx("span",{className:"mr-2",children:"←"})," Volver al inicio"]})}),e.jsxs("header",{className:"mb-8 text-center",children:[e.jsx("h1",{className:"mt-3 bg-gradient-to-r from-red-500 via-red-400 to-rose-400 bg-clip-text text-3xl font-extrabold text-transparent md:text-4xl",children:"Definir nueva contraseña"}),e.jsx("p",{className:"mx-auto mt-2 max-w-2xl text-sm text-white/70",children:"Crea tu nueva contraseña para continuar."})]}),e.jsxs("section",{className:"rounded-2xl border border-white/10 bg-white/5 p-5 shadow-lg md:bg-white/10 md:backdrop-blur-md md:p-8",children:[u&&e.jsx("div",{className:"mb-4 rounded-lg border border-white/20 bg-white/10 px-3 py-2 text-sm text-white",children:u}),h&&e.jsx("div",{className:"mb-4 rounded-lg border border-red-900/40 bg-red-900/20 px-3 py-2 text-sm text-red-200",children:h}),e.jsxs("form",{onSubmit:y,className:"space-y-6",noValidate:!0,children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{htmlFor:"password",className:"text-sm font-medium text-white",children:"Nueva contraseña"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{id:"password",type:i?"text":"password",autoComplete:"new-password",value:r,onChange:t=>g(t.target.value),className:"w-full rounded-lg border border-white/10 bg-white/5 px-3 py-2.5 pr-20 text-white placeholder-white/40 outline-none transition focus:ring-2 focus:ring-red-500/60",placeholder:"Mínimo 6 caracteres",required:!0}),e.jsx("button",{type:"button",onClick:()=>j(t=>!t),className:"absolute right-2 top-1/2 -translate-y-1/2 rounded-md px-2 py-1 text-xs text-white/70 hover:text-white","aria-label":i?"Ocultar contraseña":"Mostrar contraseña",children:i?"Ocultar":"Mostrar"})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{htmlFor:"confirm",className:"text-sm font-medium text-white",children:"Confirmar contraseña"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{id:"confirm",type:l?"text":"password",autoComplete:"new-password",value:o,onChange:t=>v(t.target.value),className:"w-full rounded-lg border border-white/10 bg-white/5 px-3 py-2.5 pr-20 text-white placeholder-white/40 outline-none transition focus:ring-2 focus:ring-red-500/60",placeholder:"Repite la contraseña",required:!0}),e.jsx("button",{type:"button",onClick:()=>N(t=>!t),className:"absolute right-2 top-1/2 -translate-y-1/2 rounded-md px-2 py-1 text-xs text-white/70 hover:text-white","aria-label":l?"Ocultar confirmación":"Mostrar confirmación",children:l?"Ocultar":"Mostrar"})]})]}),e.jsxs("div",{className:"pt-2 flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[e.jsx("button",{type:"submit",disabled:p||!r||!o,className:"flex w-full items-center justify-center gap-2 rounded-lg px-4 py-2 text-sm font-semibold text-white transition-all duration-200 hover:opacity-95 disabled:cursor-not-allowed disabled:opacity-60 sm:w-auto",style:{WebkitAppearance:"none",backgroundColor:"#dc2626"},children:p?"Guardando…":"Guardar nueva contraseña"}),e.jsxs("div",{className:"text-center text-sm text-white/70 sm:text-right",children:["¿Recordaste tu clave?"," ",e.jsx(w,{to:"/login",className:"text-white hover:underline",children:"Inicia sesión"})]})]}),e.jsx("p",{className:"pt-4 text-center text-xs text-white/50",children:"Obligados al exilio… no hay abrazo que cierre lo que la dictadura parte."})]})]})]})})}export{P as default};
