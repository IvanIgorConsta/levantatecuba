import{c as A,k as ne,q as ae,s as ie,r as c,j as e,L as h,t as S,M as le,v as ce,V as oe}from"./index-1606e3a6.js";import{p as de}from"./purify.es-ee0e7e34.js";import{g as me}from"./shopifyClient-c9f36648.js";import{L as xe}from"./loader-circle-de7850c1.js";import{A as C}from"./arrow-left-0b0d6e68.js";import{S as ue}from"./shield-226a05e9.js";/**
 * @license lucide-react v0.519.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],H=A("check",he);/**
 * @license lucide-react v0.519.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pe=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],R=A("package",pe);/**
 * @license lucide-react v0.519.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fe=[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]],ge=A("truck",fe);function we(){var q,O;const{handle:N}=ne(),B=ae(),{addItem:K,open:Q}=ie(),V=((q=B.state)==null?void 0:q.product)||null,[t,W]=c.useState(V),[G,P]=c.useState(!0),[J,p]=c.useState(null),[o,I]=c.useState(null),[d,T]=c.useState(null),[u,z]=c.useState(1),[X,E]=c.useState(!1),[y,L]=c.useState(0),[D,M]=c.useState(!1),f=s=>String(s||"").toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/\s+/g,"").replace("colour","color").replace("talla","size").replace("tamano","size").replace("tamaño","size"),g=s=>String(s??"").trim().toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,""),j=s=>s?Array.isArray(s)?s.length===1&&typeof s[0]=="string"&&s[0].includes(",")?s[0].split(",").map(a=>a.trim()).filter(Boolean):s.map(a=>String(a).trim()).filter(Boolean):typeof s=="string"?s.split(",").map(a=>a.trim()).filter(Boolean):[]:[],_=(s,a)=>{if(!Array.isArray(s))return null;const n=f(a);for(const r of s)if(f((r==null?void 0:r.key)||(r==null?void 0:r.name)||"")===n)return(r==null?void 0:r.value)||null;return null},b=(s,a)=>{const n=f(a);return((s==null?void 0:s.options)||[]).find(r=>f((r==null?void 0:r.key)||(r==null?void 0:r.name)||"")===n)};c.useEffect(()=>{let s=!1;return(async()=>{try{console.log("[ProductoDetalle] Cargando producto con handle:",N),P(!0),p(null);const n=await me(N);if(s)return;if(n){console.log("[ProductoDetalle] ✅ Producto cargado:",n.title),W(n);const r=b(n,"color"),l=b(n,"size");if(r){const m=j(r.values);I(m[0]||null)}if(l){const m=j(l.values);T(m[0]||null)}}else p("Producto no encontrado")}catch(n){if(s)return;console.error("[ProductoDetalle] ❌ Error:",n),n.message==="PRODUCT_NOT_FOUND"?p("Producto no encontrado"):p("Error al cargar el producto. Verifica tu conexión.")}finally{s||P(!1)}})(),()=>{s=!0}},[N]);const x=c.useMemo(()=>{var a,n;if(!t)return[null];const s=[];return(t.imageUrl||(a=t.featuredImage)!=null&&a.url)&&s.push(t.imageUrl||t.featuredImage.url),t.variants&&Array.isArray(t.variants)&&t.variants.forEach(r=>{var m;const l=((m=r.image)==null?void 0:m.url)||r.imageUrl;l&&!s.includes(l)&&s.push(l)}),(n=t.images)!=null&&n.edges?t.images.edges.forEach(r=>{var l;(l=r.node)!=null&&l.url&&!s.includes(r.node.url)&&s.push(r.node.url)}):t.images&&Array.isArray(t.images)&&t.images.forEach(r=>{const l=r.url||r.src||r;l&&!s.includes(l)&&s.push(l)}),s.length>0?s:[null]},[t]),i=c.useMemo(()=>{var a;return(a=t==null?void 0:t.variants)!=null&&a.length&&(t.variants.find(n=>{const r=_(n==null?void 0:n.selectedOptions,"color"),l=_(n==null?void 0:n.selectedOptions,"size"),m=!o||g(r||"")===g(o),re=!d||g(l)===g(d);return m&&re})||t.variants[0])||null},[t,o,d]);c.useEffect(()=>{var a;if(!i)return;const s=((a=i.image)==null?void 0:a.url)||i.imageUrl;if(s&&x.length>0){const n=x.findIndex(r=>r===s);n>=0&&L(n)}},[i,x]);const v=c.useMemo(()=>{var a,n,r;const s=((a=i==null?void 0:i.price)==null?void 0:a.amount)||(i==null?void 0:i.price);return typeof s=="number"&&!Number.isNaN(s)?s:t!=null&&t.price?parseFloat(t.price):(r=(n=t==null?void 0:t.priceRange)==null?void 0:n.minVariantPrice)!=null&&r.amount?parseFloat(t.priceRange.minVariantPrice.amount):null},[i,t]),Y=v!=null?Number(v).toFixed(2):null,$=(t==null?void 0:t.currencyCode)||((O=i==null?void 0:i.price)==null?void 0:O.currencyCode)||"USD",Z=()=>{var a,n;E(!0);const s={productId:t.id,handle:t.handle,title:t.title,price:v,currency:$,image:((a=i==null?void 0:i.image)==null?void 0:a.url)||(i==null?void 0:i.imageUrl)||t.imageUrl||((n=t.featuredImage)==null?void 0:n.url)||"",quantity:u,selectedColor:o,selectedSize:d,variant:i};K(s),oe.success(e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex-shrink-0 w-12 h-12 bg-green-600 rounded-full flex items-center justify-center",children:e.jsx(H,{size:24,className:"text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-white",children:"¡Producto agregado!"}),e.jsx("p",{className:"text-sm text-gray-200",children:t.title}),e.jsxs("p",{className:"text-xs text-gray-300",children:[o&&`Color: ${o}`,o&&d&&" • ",d&&`Talla: ${d}`]})]})]}),{duration:3e3,position:"bottom-right",style:{background:"#18181b",border:"1px solid #27272a",borderRadius:"12px",padding:"16px",boxShadow:"0 10px 40px rgba(0,0,0,0.3)"},icon:null}),M(!0),setTimeout(()=>{Q()},800),setTimeout(()=>{E(!1),M(!1),z(1)},1500)},ee=()=>{u<10&&z(u+1)},se=()=>{u>1&&z(u-1)},te=c.useMemo(()=>{const s=(t==null?void 0:t.descriptionHtml)||(t==null?void 0:t.description)||"";return s?de.sanitize(s,{ALLOWED_TAGS:["p","ul","li","br","strong","em","b","i"],ALLOWED_ATTR:["class"]}):'<p class="text-zinc-400">Este producto no tiene descripción disponible.</p>'},[t]);if(G)return e.jsx("div",{className:"min-h-screen bg-zinc-950 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(xe,{className:"animate-spin text-red-500 mx-auto mb-4",size:48}),e.jsx("p",{className:"text-zinc-400",children:"Cargando producto..."})]})});if(J||!t)return e.jsx("div",{className:"min-h-screen bg-zinc-950 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(R,{className:"text-zinc-600 mx-auto mb-4",size:64}),e.jsx("h2",{className:"text-2xl font-semibold text-white mb-2",children:"❌ Producto no encontrado"}),e.jsx("p",{className:"text-zinc-400 mb-6",children:"El producto que buscas no está disponible o no existe."}),e.jsxs(h,{to:"/tienda",className:"inline-flex items-center gap-2 px-6 py-3 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors",children:[e.jsx(C,{size:20}),"Volver a la tienda"]})]})});const w=b(t,"color"),k=b(t,"size"),U=j(w==null?void 0:w.values),F=j(k==null?void 0:k.values);return e.jsxs("div",{className:"min-h-screen bg-zinc-950 text-white",children:[e.jsx("div",{className:"container mx-auto px-4 py-4",children:e.jsxs("nav",{className:"flex items-center gap-2 text-sm",children:[e.jsx(h,{to:"/",className:"text-zinc-400 hover:text-white transition-colors",children:"Inicio"}),e.jsx("span",{className:"text-zinc-600",children:"/"}),e.jsx(h,{to:"/tienda",className:"text-zinc-400 hover:text-white transition-colors",children:"Tienda"}),e.jsx("span",{className:"text-zinc-600",children:"/"}),e.jsx("span",{className:"text-red-500",children:t.title})]})}),e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-12",children:[e.jsxs("div",{children:[e.jsx("div",{className:"aspect-square bg-zinc-900 rounded-lg overflow-hidden border border-zinc-800 mb-4",children:x[y]?e.jsx("img",{src:x[y],alt:t.title,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(S,{className:"text-zinc-700",size:64})})}),x.length>1&&e.jsx("div",{className:"grid grid-cols-4 gap-2",children:x.map((s,a)=>e.jsx("button",{onClick:()=>L(a),className:`aspect-square bg-zinc-900 rounded-lg overflow-hidden border-2 transition-all ${y===a?"border-red-500":"border-zinc-800 hover:border-zinc-600"}`,children:s?e.jsx("img",{src:s,alt:`${t.title} ${a+1}`,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(S,{className:"text-zinc-700",size:24})})},a))})]}),e.jsxs("div",{children:[e.jsx("div",{className:"mb-6",children:e.jsxs(h,{to:"/tienda",className:"inline-flex items-center gap-2 text-red-500 hover:text-red-400 transition-colors font-medium text-sm group",children:[e.jsx(C,{size:18,className:"group-hover:-translate-x-1 transition-transform"}),"Volver a la Tienda"]})}),e.jsx("h1",{className:"text-3xl lg:text-4xl font-bold mb-4",children:t.title}),e.jsxs("div",{className:"flex items-baseline gap-3 mb-6",children:[e.jsxs("span",{className:"text-4xl font-bold text-red-500",children:["$",Y||"0.00"]}),e.jsx("span",{className:"text-lg text-zinc-400",children:$})]}),e.jsx("div",{className:"prose prose-invert max-w-none mb-8 text-zinc-300 leading-relaxed",dangerouslySetInnerHTML:{__html:te}}),U.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsxs("h3",{className:"text-sm font-medium text-zinc-400 mb-3",children:["Color: ",e.jsx("span",{className:"text-white ml-2",children:o})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:U.map(s=>e.jsx("button",{onClick:()=>I(s),className:`px-4 py-2 rounded-lg border-2 transition-all ${o===s?"bg-red-600 border-red-600 text-white":"bg-zinc-900 border-zinc-700 text-zinc-300 hover:border-red-500/50"}`,children:s},s))})]}),F.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsxs("h3",{className:"text-sm font-medium text-zinc-400 mb-3",children:["Talla: ",e.jsx("span",{className:"text-white ml-2",children:d})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:F.map(s=>e.jsx("button",{onClick:()=>T(s),className:`w-12 h-12 rounded-lg border-2 transition-all font-medium ${d===s?"bg-white border-white text-black":"bg-zinc-900 border-zinc-700 text-zinc-300 hover:border-red-500/50"}`,children:s},s))})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-sm font-medium text-zinc-400 mb-3",children:"Cantidad"}),e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs("div",{className:"flex items-center bg-zinc-900 rounded-lg border border-zinc-700",children:[e.jsx("button",{onClick:se,className:"p-3 text-zinc-400 hover:text-white transition-colors","aria-label":"Disminuir cantidad",children:e.jsx(le,{size:20})}),e.jsx("span",{className:"px-6 py-2 text-white font-medium min-w-[80px] text-center",children:u}),e.jsx("button",{onClick:ee,className:"p-3 text-zinc-400 hover:text-white transition-colors","aria-label":"Aumentar cantidad",children:e.jsx(ce,{size:20})})]})})]}),e.jsx("button",{onClick:Z,disabled:X,className:`w-full py-4 px-6 rounded-lg font-semibold text-lg transition-all duration-300 flex items-center justify-center gap-3 ${D?"bg-green-600 text-white":"bg-red-600 hover:bg-red-700 text-white"} disabled:opacity-50 disabled:cursor-not-allowed`,children:D?e.jsxs(e.Fragment,{children:[e.jsx(H,{size:24}),e.jsx("span",{children:"¡Agregado al carrito!"})]}):e.jsxs(e.Fragment,{children:[e.jsx(S,{size:24}),e.jsx("span",{children:"Agregar al carrito"})]})}),e.jsxs("div",{className:"mt-8 space-y-4 border-t border-zinc-800 pt-8",children:[e.jsxs("div",{className:"flex items-center gap-3 text-zinc-400",children:[e.jsx(ge,{size:20}),e.jsx("span",{children:"Envío a todo el mundo"})]}),e.jsxs("div",{className:"flex items-center gap-3 text-zinc-400",children:[e.jsx(ue,{size:20}),e.jsx("span",{children:"Compra segura"})]}),e.jsxs("div",{className:"flex items-center gap-3 text-zinc-400",children:[e.jsx(R,{size:20}),e.jsx("span",{children:"Producto de calidad garantizada"})]})]})]})]}),e.jsxs("div",{className:"mt-16 pt-16 border-t border-zinc-800",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"También te puede interesar"}),e.jsxs(h,{to:"/tienda",className:"text-red-500 hover:text-red-400 transition-colors flex items-center gap-2",children:["Ver todos los productos",e.jsx(C,{className:"rotate-180",size:20})]})]}),e.jsx("div",{className:"bg-zinc-900/50 rounded-lg p-8 text-center",children:e.jsx("p",{className:"text-zinc-400",children:"Próximamente agregaremos más productos relacionados"})})]})]})]})}export{we as default};
